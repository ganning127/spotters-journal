create table public."AircraftType" (
  id text not null,
  manufacturer text not null,
  type text not null,
  variant text null,
  constraint AircraftType_pkey primary key (id)
) TABLESPACE pg_default;

create table public."Airline" (
  code text not null,
  name text not null,
  created_at timestamp with time zone null default now(),
  reg_suffix text[] null,
  reg_prefix text[] null,
  brand_color text null,
  constraint Airline_pkey primary key (code)
) TABLESPACE pg_default;

create table public."Airport" (
  icao_code text not null,
  name text not null,
  latitude real null,
  longitude real null,
  elevation smallint null,
  state text null,
  country text null,
  constraint Airport_pkey primary key (icao_code)
) TABLESPACE pg_default;

create table public."Photo" (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone null default now(),
  registration text null,
  airport_code text null,
  user_id bigint not null,
  image_url text not null,
  taken_at timestamp with time zone null,
  shutter_speed text null,
  iso integer null,
  aperture text null,
  camera_model text null,
  focal_length text null,
  constraint Photo_pkey primary key (id),
  constraint Photo_airport_code_fkey foreign KEY (airport_code) references "Airport" (icao_code),
  constraint Photo_registration_fkey foreign KEY (registration) references "SpecificAircraft" (registration) on update CASCADE,
  constraint Photo_user_id_fkey foreign KEY (user_id) references "User" (id)
) TABLESPACE pg_default;

create table public."SpecificAircraft" (
  registration text not null,
  created_at timestamp with time zone not null default now(),
  type_id text null,
  manufactured_date date null,
  airline text null,
  constraint SpecificAircraft_pkey primary key (registration),
  constraint SpecificAircraft_airline_fkey foreign KEY (airline) references "Airline" (code) on update CASCADE on delete set null,
  constraint SpecificAircraft_type_id_fkey foreign KEY (type_id) references "AircraftType" (id)
) TABLESPACE pg_default;

create table public."User" (
  id bigint generated by default as identity not null,
  username text not null,
  password_hash text not null,
  created_at timestamp with time zone null default now(),
  type text null default 'user'::text,
  constraint User_pkey primary key (id),
  constraint User_username_key unique (username),
  constraint User_type_check check ((type = any (array['admin'::text, 'user'::text])))
) TABLESPACE pg_default;